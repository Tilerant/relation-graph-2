# ç³»ç»Ÿæ¶æ„è®¾è®¡

## Electronæ¡Œé¢åº”ç”¨æ¶æ„

### è·¨å¹³å°æ¡Œé¢åº”ç”¨è®¾è®¡

åŸºäºElectronçš„AIçŸ¥è¯†å›¾è°±æ¡Œé¢åº”ç”¨ï¼Œæä¾›åŸç”Ÿåº”ç”¨ä½“éªŒå’Œæœ¬åœ°æ•°æ®å®‰å…¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Electronåº”ç”¨æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  ä¸»è¿›ç¨‹      â”‚    â”‚  æ¸²æŸ“è¿›ç¨‹    â”‚    â”‚  åŸç”Ÿé›†æˆ    â”‚     â”‚
â”‚  â”‚ (Main)      â”‚    â”‚(Renderer)  â”‚    â”‚ (Native)   â”‚     â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚     â”‚
â”‚  â”‚â€¢ åº”ç”¨ç”Ÿå‘½å‘¨æœŸ  â”‚    â”‚â€¢ Reactå‰ç«¯   â”‚    â”‚â€¢ æ–‡ä»¶ç³»ç»Ÿ    â”‚     â”‚
â”‚  â”‚â€¢ çª—å£ç®¡ç†    â”‚    â”‚â€¢ AIäº¤äº’ç•Œé¢  â”‚    â”‚â€¢ ç³»ç»Ÿæ‰˜ç›˜    â”‚     â”‚
â”‚  â”‚â€¢ IPCé€šä¿¡     â”‚    â”‚â€¢ å›¾è°±æ¸²æŸ“    â”‚    â”‚â€¢ å…¨å±€å¿«æ·é”®  â”‚     â”‚
â”‚  â”‚â€¢ å®‰å…¨å­˜å‚¨    â”‚    â”‚â€¢ çŠ¶æ€ç®¡ç†    â”‚    â”‚â€¢ è‡ªåŠ¨æ›´æ–°    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Electronç‰¹å®šä¼˜åŠ¿

#### 1. åŸç”Ÿæ¡Œé¢ä½“éªŒ
- **ç³»ç»Ÿçº§å¿«æ·é”®**: Cmd+Spaceå”¤èµ·AIåŠ©æ‰‹ç­‰å…¨å±€å¿«æ·é”®
- **æ–‡ä»¶å…³è”**: .graphæ–‡ä»¶åŒå‡»è‡ªåŠ¨æ‰“å¼€
- **ç³»ç»Ÿæ‰˜ç›˜**: åå°è¿è¡Œï¼Œéšæ—¶è°ƒç”¨
- **åŸç”Ÿçª—å£**: ç³»ç»ŸåŸç”Ÿå¤–è§‚å’Œæ“ä½œ

#### 2. æ•°æ®å®‰å…¨ä¸éšç§
- **æœ¬åœ°å­˜å‚¨**: æ‰€æœ‰ç”¨æˆ·æ•°æ®å®Œå…¨æœ¬åœ°åŒ–
- **åŠ å¯†APIå¯†é’¥**: ç³»ç»Ÿçº§å®‰å…¨å­˜å‚¨APIå¯†é’¥
- **ç¦»çº¿å¯ç”¨**: æ ¸å¿ƒç¼–è¾‘åŠŸèƒ½æ— éœ€ç½‘ç»œ
- **è‡ªåŠ¨å¤‡ä»½**: æœ¬åœ°å¢é‡å¤‡ä»½æœºåˆ¶

#### 3. AIé›†æˆä¼˜åŠ¿
- **å¤šæ¨¡å‹æ”¯æŒ**: OpenAIã€Claudeã€æœ¬åœ°æ¨¡å‹çµæ´»åˆ‡æ¢
- **è¯·æ±‚ç¼“å­˜**: æœ¬åœ°ç¼“å­˜AIå“åº”ï¼ŒèŠ‚çœæˆæœ¬
- **ä½¿ç”¨ç»Ÿè®¡**: æœ¬åœ°è·Ÿè¸ªAIä½¿ç”¨é‡å’Œè´¹ç”¨
- **éšç§ä¿æŠ¤**: AIè¯·æ±‚é€šè¿‡ä¸»è¿›ç¨‹ï¼Œå¢å¼ºå®‰å…¨æ€§

## åˆ†å±‚æ¶æ„æ ¸å¿ƒç†å¿µ

åŸºäº**èŠ‚ç‚¹ç±»å‹åŒ–æ¶æ„**ï¼Œç³»ç»Ÿé‡‡ç”¨**ä¸‰å±‚åˆ†ç¦»è®¾è®¡**ï¼Œå®ç°çŸ¥è¯†è¯­ä¹‰ã€åŠŸèƒ½åº”ç”¨ä¸è§†è§‰å‘ˆç°çš„å®Œç¾åˆ†ç¦»ï¼š

```
çŸ¥è¯†å±‚ï¼ˆè¯­ä¹‰å®ä½“ï¼‰â†’ åŠŸèƒ½å±‚ï¼ˆåŠŸèƒ½å®ä½“ï¼‰â†’ è§†å›¾å±‚ï¼ˆè¡¨ç°ï¼‰
    â†“                  â†“               â†“
ContentNode/         WorkflowNode/    Layout/Style/
RelationNode/        ComputeNode/     UI/Temp
Edge                 MediaNode
     â†“                  â†“               â†“
   AIç†è§£             ä¸“ç”¨åŠŸèƒ½         å¤šè§†å›¾å‘ˆç°
```

### æ¶æ„è®¾è®¡ä¼˜åŠ¿
- **è¯­ä¹‰çº¯å‡€**: çŸ¥è¯†å±‚åªåŒ…å«çœŸæ­£çš„çŸ¥è¯†å®ä½“ï¼ŒAIå¯ä¸“æ³¨è¯­ä¹‰æ“ä½œ
- **åŠŸèƒ½åˆ†å±‚**: åŠŸèƒ½å±‚æ‰¿è½½åº”ç”¨é€»è¾‘ï¼Œä¸çŸ¥è¯†è¯­ä¹‰åˆ†ç¦»
- **ç±»å‹å®‰å…¨**: èŠ‚ç‚¹ç±»å‹åŒ–è®¾è®¡ç¡®ä¿æ“ä½œçš„ç²¾ç¡®æ€§å’Œå®‰å…¨æ€§
- **AIåä½œ**: å¤§æ¨¡å‹æ ¹æ®å®ä½“å±‚çº§é€‰æ‹©åˆé€‚çš„å¤„ç†ç­–ç•¥

## èŠ‚ç‚¹ç±»å‹åŒ–æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è§†å›¾å±‚ (View Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ç™½æ¿è§†å›¾    â”‚  â”‚  çº¿æ€§è§†å›¾    â”‚  â”‚   ä¸´æ—¶å…ƒç´ ç®¡ç†       â”‚   â”‚
â”‚  â”‚(Whiteboard) â”‚  â”‚ (Linear)    â”‚  â”‚ (Temp Elements)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åŠŸèƒ½å±‚ (Functional Layer)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å·¥ä½œæµèŠ‚ç‚¹   â”‚  â”‚   è®¡ç®—èŠ‚ç‚¹   â”‚  â”‚     åª’ä½“èŠ‚ç‚¹         â”‚   â”‚
â”‚  â”‚(WorkflowNode)â”‚ â”‚(ComputeNode)â”‚  â”‚  (MediaNode)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    äº¤äº’æ§åˆ¶å±‚ (Interaction)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å‘½ä»¤ç³»ç»Ÿ    â”‚  â”‚ AIåä½œå¼•æ“   â”‚  â”‚   Obsidiané£æ ¼     â”‚   â”‚
â”‚  â”‚ (Command)   â”‚  â”‚ (AI Engine) â”‚  â”‚   æ’ä»¶ç³»ç»Ÿ         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    çŸ¥è¯†å±‚ (Knowledge Layer)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   å†…å®¹èŠ‚ç‚¹    â”‚  â”‚   å…³ç³»èŠ‚ç‚¹   â”‚  â”‚       ç®€å•è¾¹         â”‚   â”‚
â”‚  â”‚(ContentNode)â”‚  â”‚(RelationNode)â”‚ â”‚     (Edge)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¶æ„å±‚æ¬¡

### 1. çŸ¥è¯†å±‚ (Knowledge Layer) - è¯­ä¹‰æ ¸å¿ƒ

#### æ ¸å¿ƒå®ä½“
- **Node**: çŸ¥è¯†èŠ‚ç‚¹ï¼ŒåŒ…å«ç»“æ„åŒ–å†…å®¹å—ï¼ŒAIç†è§£çš„åŸºæœ¬å•å…ƒ
- **Edge**: è¯­ä¹‰è¿æ¥ï¼Œè¡¨ç¤ºèŠ‚ç‚¹é—´çš„å…³ç³»ï¼Œæ”¯æŒç±»å‹åŒ–æŸ¥è¯¢
- **RelationNode**: å¤æ‚å…³ç³»(è¶…è¾¹)ï¼Œæ”¯æŒå¤šå‚ä¸è€…ï¼ŒAIæ¨ç†çš„é‡ç‚¹
- **Block**: ç»“æ„åŒ–å†…å®¹å•å…ƒï¼Œnotioné£æ ¼çš„å¯Œå†…å®¹è½½ä½“
- **KnowledgeBase**: çŸ¥è¯†åº“å®¹å™¨ï¼ŒAIæ“ä½œçš„ä¸»è¦å¯¹è±¡

#### ç‰¹å¾ä¸ä¼˜åŠ¿
- **è¯­ä¹‰çº¯å‡€**: ä¸åŒ…å«è§†è§‰è¡¨ç°ä¿¡æ¯ï¼Œä¸“æ³¨è¯­ä¹‰ç»“æ„
- **AIå‹å¥½**: å¤§æ¨¡å‹å¯ç›´æ¥ç†è§£å’Œæ“ä½œçš„æ•°æ®ç»“æ„  
- **ç‰ˆæœ¬åŒ–**: å®Œæ•´çš„åˆ›å»º/æ›´æ–°å†å²ï¼Œæ”¯æŒåä½œå’Œå›æ»š
- **å¯æ‰©å±•**: æ”¯æŒè‡ªå®šä¹‰å±æ€§å’ŒåŠ¨æ€æ ‡ç­¾ç³»ç»Ÿ
- **ç±»å‹å®‰å…¨**: ä¸¥æ ¼çš„ TypeScript ç±»å‹å®šä¹‰

### 2. è§†å›¾å±‚ (View Layer) - è¡¨ç°å½¢å¼

#### å¤šè§†å›¾æ”¯æŒ
- **ç™½æ¿è§†å›¾**: è‡ªç”±ç©ºé—´å¸ƒå±€ï¼Œæ”¯æŒå›¾å½¢åŒ–äº¤äº’
- **çº¿æ€§è§†å›¾**: å¯Œæ–‡æœ¬ã€è¡¨æ ¼ã€çœ‹æ¿ã€åˆ—è¡¨ç­‰ç»“æ„åŒ–å±•ç¤º
- **åª’ä½“è§†å›¾**: PDFã€å›¾ç‰‡ã€è§†é¢‘ç­‰åª’ä½“å†…å®¹æ¸²æŸ“
- **è‡ªå®šä¹‰è§†å›¾**: æ’ä»¶æ‰©å±•çš„ä¸“ä¸šåŒ–è§†å›¾

#### è§†å›¾ç‰¹æ€§
- **åŒä¸€çŸ¥è¯†å¤šæ ·å‘ˆç°**: ä¸€ä¸ªçŸ¥è¯†ç»“æ„å¯ä»¥æœ‰å¤šç§è§†è§‰è¡¨ç°
- **å¸ƒå±€ä¸æ ·å¼åˆ†ç¦»**: å¸ƒå±€ä¿¡æ¯ç‹¬ç«‹äºçŸ¥è¯†ç»“æ„å­˜å‚¨
- **å“åº”å¼é€‚é…**: æ”¯æŒä¸åŒè®¾å¤‡å’Œå±å¹•å°ºå¯¸
- **æ’ä»¶æ‰©å±•**: æ”¯æŒç¬¬ä¸‰æ–¹è§†å›¾æ ¼å¼æ’ä»¶

### 3. äº¤äº’æ§åˆ¶å±‚ (Interaction Layer)

#### æ ¸å¿ƒç»„ä»¶
- **å‘½ä»¤ç³»ç»Ÿ**: ç»Ÿä¸€çš„æ“ä½œå…¥å£ï¼Œæ”¯æŒæ’¤é”€/é‡åš
- **AIåä½œå¼•æ“**: å¤§æ¨¡å‹æ·±åº¦é›†æˆï¼Œæ™ºèƒ½è¾…åŠ©æ“ä½œ  
- **æ’ä»¶ç®¡ç†**: åŠ¨æ€åŠ è½½ã€çƒ­æ’æ‹”çš„åŠŸèƒ½æ‰©å±•
#### AIåä½œå¼•æ“æ¶æ„

æ ¸å¿ƒä»·å€¼ï¼š**AIç›´æ¥æ“ä½œç™½æ¿ï¼Œç”¨è‡ªç„¶è¯­è¨€åˆ›å»ºçŸ¥è¯†ç»“æ„**

```typescript
interface AICollaborationEngine {
  // ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ï¼šè‡ªç„¶è¯­è¨€å›¾è°±æ“ä½œ
  naturalLanguageOperations: {
    // ä¸€å¥è¯åˆ›å»ºæ•´ä¸ªçŸ¥è¯†ç»“æ„
    createKnowledgeStructure(prompt: string): Promise<GraphOperation[]>;
    
    // æ™ºèƒ½èŠ‚ç‚¹å’Œå…³ç³»ç”Ÿæˆ
    parseUserIntent(input: string): Promise<AIOperation[]>;
    
    // å®æ—¶å›¾è°±æ“ä½œ
    executeGraphCommands(operations: AIOperation[]): Promise<CommandResult[]>;
  };
  
  // ğŸ§  æ™ºèƒ½å…³ç³»å»ºè®®
  relationSuggestion: {
    analyzeContent(nodes: Node[]): RelationSuggestion[];
    suggestConnections(context: KnowledgeBase): Edge[];
    detectPatterns(graph: KnowledgeGraph): Pattern[];
    autoLayout(nodes: Node[], edges: Edge[]): LayoutSuggestion;
  };
  
  // âœ¨ å†…å®¹æ™ºèƒ½ç”Ÿæˆ  
  contentGeneration: {
    generateNode(prompt: string, context: Node[]): Node;
    expandContent(node: Node, direction: string): Block[];
    summarizeGraph(view: View): string;
    generateRelationContent(edge: Edge): RelationDescription;
  };
  
  // ğŸ”„ çŸ¥è¯†ä¼˜åŒ–
  knowledgeOptimization: {
    optimizeStructure(kb: KnowledgeBase): OptimizationSuggestion[];
    detectDuplicates(nodes: Node[]): DuplicateGroup[];
    suggestCategories(nodes: Node[]): Category[];
    improveConnections(graph: Graph): ConnectionImprovement[];
  };
  
  // ğŸ›ï¸ AIé…ç½®å’Œæ¨¡å‹ç®¡ç†
  modelConfiguration: {
    setAPIKey(provider: 'openai' | 'anthropic', key: string): void;
    configureModel(model: AIModel): void;
    adjustParameters(params: AIParameters): void;
  };
}
```

#### AIæ“ä½œçš„"é­”æ³•ç¬é—´"å®ç°

**ç”¨æˆ·ä½“éªŒç›®æ ‡**ï¼šç”¨ä¸€å¥è¯ï¼Œè®©AIåˆ›å»ºå¹¶è¿æ¥å¤šä¸ªèŠ‚ç‚¹ï¼Œæ„å»ºå®Œæ•´çŸ¥è¯†ç»“æ„

```typescript
// ç”¨æˆ·è¾“å…¥ï¼š"åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„çŸ¥è¯†å›¾è°±"
// AIè¾“å‡ºï¼š
interface AIGraphCreationExample {
  input: "åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„çŸ¥è¯†å›¾è°±";
  
  aiResponse: {
    operations: [
      {
        type: 'create_node',
        params: {
          nodeType: 'content',
          title: 'äººå·¥æ™ºèƒ½',
          content: 'äººå·¥æ™ºèƒ½(AI)æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯...',
          position: { x: 200, y: 100 }
        }
      },
      {
        type: 'create_node',
        params: {
          nodeType: 'content', 
          title: 'æœºå™¨å­¦ä¹ ',
          content: 'æœºå™¨å­¦ä¹ æ˜¯AIçš„æ ¸å¿ƒæŠ€æœ¯...',
          position: { x: 100, y: 250 }
        }
      },
      {
        type: 'create_edge',
        params: {
          sourceId: 'äººå·¥æ™ºèƒ½',
          targetId: 'æœºå™¨å­¦ä¹ ', 
          relationType: 'contains'
        }
      }
      // ... æ›´å¤šæ“ä½œ
    ],
    explanation: 'æˆ‘ä¸ºä½ åˆ›å»ºäº†äººå·¥æ™ºèƒ½çŸ¥è¯†å›¾è°±ï¼ŒåŒ…å«ä¸»è¦åˆ†æ”¯å’Œæ ¸å¿ƒæ¦‚å¿µçš„è¿æ¥å…³ç³»ã€‚'
  }
}
```

#### AIä¸å‘½ä»¤ç³»ç»Ÿé›†æˆæ¶æ„

```typescript
interface AICommandIntegration {
  // AIæ“ä½œè½¬æ¢ä¸ºå¯æ’¤é”€å‘½ä»¤
  aiToCommand: {
    convertOperation(operation: AIOperation): ReversibleCommand;
    batchConvert(operations: AIOperation[]): ReversibleCommand[];
    validateOperations(operations: AIOperation[]): ValidationResult;
  };
  
  // å‘½ä»¤æ‰§è¡Œä¸AIåé¦ˆ
  commandExecution: {
    executeWithFeedback(commands: ReversibleCommand[]): Promise<AIFeedback>;
    handlePartialFailure(results: CommandResult[]): Promise<RecoveryPlan>;
    provideExecutionSummary(results: CommandResult[]): ExecutionSummary;
  };
  
  // AIä¸Šä¸‹æ–‡ç®¡ç†
  contextManagement: {
    maintainConversationContext(history: AIInteraction[]): AIContext;
    trackGraphChanges(before: Graph, after: Graph): ChangeContext;
    suggestFollowUpActions(context: AIContext): FollowUpSuggestion[];
  };
}
```

## Obsidiané£æ ¼æ’ä»¶ç³»ç»Ÿæ¶æ„

### æ’ä»¶ç³»ç»Ÿæ ¸å¿ƒè®¾è®¡

å€Ÿé‰´Obsidiançš„æˆåŠŸç»éªŒï¼ŒGraph-ccé‡‡ç”¨**ç¤¾åŒºé©±åŠ¨çš„æ’ä»¶ç”Ÿæ€**ï¼Œæ”¯æŒçµæ´»æ‰©å±•å’Œç¬¬ä¸‰æ–¹å¼€å‘ï¼š

```typescript
interface GraphPluginSystem {
  // æ’ä»¶åˆ†ç±»ä½“ç³»
  pluginCategories: {
    // æ ¸å¿ƒæ’ä»¶ï¼ˆå®˜æ–¹ç»´æŠ¤ï¼‰
    corePlugins: CorePlugin[];
    // ç¤¾åŒºæ’ä»¶ï¼ˆç¤¾åŒºå¼€å‘ï¼‰
    communityPlugins: CommunityPlugin[];
    // ä¸»é¢˜æ’ä»¶ï¼ˆè§†è§‰å®šåˆ¶ï¼‰
    themePlugins: ThemePlugin[];
  };
  
  // æ’ä»¶èƒ½åŠ›æ¥å£
  pluginCapabilities: {
    // UIæ‰©å±•èƒ½åŠ›
    uiExtensions: UIExtensionAPI;
    // æ•°æ®è®¿é—®èƒ½åŠ›
    dataAccess: DataAccessAPI;
    // èŠ‚ç‚¹ç±»å‹æ‰©å±•
    nodeTypeExtensions: NodeTypeAPI;
    // AIåŠŸèƒ½æ‰©å±•
    aiFunctionExtensions: AIFunctionAPI;
  };
  
  // æ’ä»¶ç®¡ç†ç³»ç»Ÿ
  pluginManager: {
    // æ’ä»¶å‘ç°å’Œå®‰è£…
    discovery: PluginDiscoveryService;
    // ç”Ÿå‘½å‘¨æœŸç®¡ç†
    lifecycle: PluginLifecycleManager;
    // æƒé™å’Œæ²™ç®±
    security: PluginSecurityManager;
    // æ’ä»¶é€šä¿¡
    messaging: PluginMessageBus;
  };
}
```

### æ’ä»¶èƒ½åŠ›èŒƒå›´è®¾è®¡

#### 1. UIæ‰©å±•èƒ½åŠ›
```typescript
interface UIExtensionAPI {
  // ä¸»è¦é¢æ¿æ‰©å±•
  panels: {
    leftRibbon: RibbonActionAPI;      // å·¦ä¾§å·¥å…·æ 
    rightSidebar: SidebarPaneAPI;     // å³ä¾§é¢æ¿
    statusBar: StatusBarItemAPI;      // çŠ¶æ€æ 
    commandPalette: CommandAPI;       // å‘½ä»¤é¢æ¿
  };
  
  // ç¼–è¾‘å™¨æ‰©å±•
  editor: {
    nodeEditors: NodeEditorAPI;       // èŠ‚ç‚¹ç¼–è¾‘å™¨æ‰©å±•
    toolbars: ToolbarAPI;             // å·¥å…·æ æ‰©å±•
    contextMenus: ContextMenuAPI;     // å³é”®èœå•
    shortcuts: ShortcutAPI;           // å¿«æ·é”®
  };
  
  // è§†å›¾æ‰©å±•
  views: {
    customViews: ViewRendererAPI;     // è‡ªå®šä¹‰è§†å›¾
    layoutEngines: LayoutAPI;         // å¸ƒå±€ç®—æ³•
    visualEffects: EffectAPI;         // è§†è§‰æ•ˆæœ
  };
}
```

#### 2. æ•°æ®è®¿é—®èƒ½åŠ›
```typescript
interface DataAccessAPI {
  // çŸ¥è¯†åº“è®¿é—®
  knowledgeBase: {
    // èŠ‚ç‚¹æ“ä½œ
    nodes: {
      create: (type: NodeType, data: NodeData) => Promise<BaseNode>;
      update: (nodeId: EntityId, updates: Partial<BaseNode>) => Promise<void>;
      delete: (nodeId: EntityId) => Promise<void>;
      query: (criteria: QueryCriteria) => Promise<BaseNode[]>;
    };
    
    // å…³ç³»æ“ä½œ
    relations: {
      createEdge: (from: EntityId, to: EntityId, label?: string) => Promise<Edge>;
      createRelation: (participants: EntityId[], type: string) => Promise<RelationNode>;
      queryPaths: (from: EntityId, to: EntityId) => Promise<Path[]>;
    };
    
    // è§†å›¾æ“ä½œ
    views: {
      getCurrentView: () => View;
      switchView: (viewId: EntityId) => Promise<void>;
      createView: (config: ViewConfig) => Promise<View>;
    };
  };
  
  // å…ƒæ•°æ®ç¼“å­˜
  metadata: {
    getNodeMetadata: (nodeId: EntityId) => CachedMetadata;
    getRelationships: () => Record<EntityId, RelationshipCache>;
    getTags: () => Record<string, TagUsage>;
    getBacklinks: (nodeId: EntityId) => BacklinkCache[];
  };
}
```

#### 3. èŠ‚ç‚¹ç±»å‹æ‰©å±•èƒ½åŠ›
```typescript
interface NodeTypeAPI {
  // æ³¨å†Œæ–°èŠ‚ç‚¹ç±»å‹
  registerNodeType<T extends BaseNode>(definition: NodeTypeDefinition<T>): void;
  
  // èŠ‚ç‚¹ç±»å‹å®šä¹‰
  NodeTypeDefinition: {
    typeName: string;
    displayName: string;
    icon: string;
    
    // åˆ›å»ºé€»è¾‘
    createNode: (params: CreateNodeParams) => T;
    
    // æ¸²æŸ“ç»„ä»¶
    components: {
      editor: React.ComponentType<NodeEditorProps<T>>;
      renderer: React.ComponentType<NodeRendererProps<T>>;
      toolbar: React.ComponentType<NodeToolbarProps<T>>;
      inspector: React.ComponentType<NodeInspectorProps<T>>;
    };
    
    // æ”¯æŒçš„æ“ä½œ
    operations: {
      search: (node: T, query: string) => SearchResult[];
      export: (node: T, format: string) => ExportData;
      ai: (node: T, operation: AIOperation) => Promise<AIResult>;
    };
  };
}
```

#### 4. AIåŠŸèƒ½æ‰©å±•èƒ½åŠ›
```typescript
interface AIFunctionAPI {
  // æ³¨å†ŒAIåŠŸèƒ½
  registerAIFunction(definition: AIFunctionDefinition): void;
  
  // AIåŠŸèƒ½å®šä¹‰
  AIFunctionDefinition: {
    name: string;
    description: string;
    category: 'content' | 'relation' | 'analysis' | 'automation';
    
    // é€‚ç”¨çš„èŠ‚ç‚¹ç±»å‹
    supportedNodeTypes: NodeType[];
    
    // æ‰§è¡Œæ¥å£
    execute: (params: AIFunctionParams, context: KnowledgeContext) => Promise<AIFunctionResult>;
    
    // æµå¼æ‰§è¡Œï¼ˆå¯é€‰ï¼‰
    executeStream?: (params: AIFunctionParams) => AsyncGenerator<PartialResult, FinalResult>;
    
    // é…ç½®ç•Œé¢
    settingsComponent?: React.ComponentType<AIFunctionSettingsProps>;
  };
  
  // AIæä¾›å•†é›†æˆ
  aiProviders: {
    registerProvider: (provider: AIProvider) => void;
    getAvailableProviders: () => AIProvider[];
    setDefaultProvider: (providerId: string) => void;
  };
}
```

### æ’ä»¶åˆ†ç±»å’ŒåŠŸèƒ½ç¤ºä¾‹

#### 1. æ ¸å¿ƒæ’ä»¶ç±»å‹
```typescript
// å®˜æ–¹ç»´æŠ¤çš„æ ¸å¿ƒæ’ä»¶
interface CorePlugins {
  // çŸ¥è¯†ç®¡ç†æ ¸å¿ƒ
  knowledgeCore: {
    graphAnalysis: GraphAnalysisPlugin;      // å›¾åˆ†æ
    contentSearch: ContentSearchPlugin;      // å†…å®¹æœç´¢
    backlinks: BacklinksPlugin;             // åå‘é“¾æ¥
    tags: TagManagerPlugin;                 // æ ‡ç­¾ç®¡ç†
  };
  
  // AIåä½œæ ¸å¿ƒ
  aiCore: {
    relationSuggestion: RelationSuggestionPlugin;  // å…³ç³»å»ºè®®
    contentGeneration: ContentGenerationPlugin;    // å†…å®¹ç”Ÿæˆ
    knowledgeOptimization: OptimizationPlugin;     // çŸ¥è¯†ä¼˜åŒ–
  };
  
  // è§†å›¾æ ¸å¿ƒ
  viewCore: {
    whiteboardView: WhiteboardPlugin;       // ç™½æ¿è§†å›¾
    linearView: LinearViewPlugin;           // çº¿æ€§è§†å›¾
    mediaView: MediaViewPlugin;             // åª’ä½“è§†å›¾
  };
}
```

#### 2. ç¤¾åŒºæ’ä»¶åˆ†ç±»
```typescript
interface CommunityPluginCategories {
  // ç¼–è¾‘å¢å¼ºç±»
  editingEnhancement: {
    advancedEditor: TipTapAdvancedPlugin;   // é«˜çº§ç¼–è¾‘å™¨
    templates: TemplatePlugin;              // æ¨¡æ¿ç³»ç»Ÿ
    textExpander: TextExpanderPlugin;       // æ–‡æœ¬æ‰©å±•
    mathEditor: MathEditorPlugin;           // æ•°å­¦å…¬å¼ç¼–è¾‘
  };
  
  // çŸ¥è¯†ç®¡ç†ç±»
  knowledgeManagement: {
    spacedRepetition: SpacedRepetitionPlugin;  // é—´éš”é‡å¤
    flashcards: FlashcardPlugin;               // é—ªå¡
    citation: CitationPlugin;                  // å¼•ç”¨ç®¡ç†
    bibliography: BibliographyPlugin;          // æ–‡çŒ®ç®¡ç†
  };
  
  // å¯è§†åŒ–å¢å¼ºç±»
  visualization: {
    mindMap: MindMapPlugin;                 // æ€ç»´å¯¼å›¾
    timeline: TimelinePlugin;               // æ—¶é—´çº¿
    kanban: KanbanPlugin;                  // çœ‹æ¿
    calendar: CalendarPlugin;              // æ—¥å†è§†å›¾
    charts: ChartsPlugin;                  // å›¾è¡¨ç”Ÿæˆ
  };
  
  // å·¥ä½œæµé›†æˆç±»
  workflowIntegration: {
    taskManagement: TaskManagerPlugin;      // ä»»åŠ¡ç®¡ç†
    projectPlanning: ProjectPlanPlugin;     // é¡¹ç›®è§„åˆ’
    timeTracking: TimeTrackingPlugin;       // æ—¶é—´è¿½è¸ª
    automation: AutomationPlugin;           // è‡ªåŠ¨åŒ–
  };
  
  // å¤–éƒ¨é›†æˆç±»
  externalIntegration: {
    git: GitIntegrationPlugin;              // Gité›†æˆ
    cloud: CloudSyncPlugin;                 // äº‘åŒæ­¥
    api: APIConnectorPlugin;                // APIè¿æ¥å™¨
    database: DatabasePlugin;               // æ•°æ®åº“è¿æ¥
  };
  
  // AIä¸“ä¸šåŒ–ç±»
  aiSpecialization: {
    codeAnalysis: CodeAnalysisPlugin;       // ä»£ç åˆ†æAI
    academicWriting: AcademicWritingPlugin; // å­¦æœ¯å†™ä½œAI
    businessAnalysis: BusinessAnalysisPlugin; // å•†ä¸šåˆ†æAI
    creativeWriting: CreativeWritingPlugin; // åˆ›æ„å†™ä½œAI
  };
}
```

### æ’ä»¶å¼€å‘æ¡†æ¶

#### 1. æ’ä»¶åŸºç¡€ç»“æ„
```typescript
// æ’ä»¶ä¸»ç±»
export default class MyPlugin extends GraphPlugin {
  settings: MyPluginSettings;
  
  async onload() {
    // æ’ä»¶åŠ è½½æ—¶æ‰§è¡Œ
    await this.loadSettings();
    
    // æ³¨å†Œå‘½ä»¤
    this.addCommand({
      id: 'my-plugin-command',
      name: 'My Plugin Command',
      callback: () => this.executeCommand(),
      hotkeys: [{ modifiers: ['Mod'], key: 'k' }]
    });
    
    // æ³¨å†ŒUIç»„ä»¶
    this.addRibbonIcon('my-icon', 'My Plugin', () => {
      this.openPluginView();
    });
    
    // æ³¨å†ŒèŠ‚ç‚¹ç±»å‹ï¼ˆå¦‚æœéœ€è¦ï¼‰
    this.registerNodeType({
      typeName: 'my-custom-node',
      displayName: 'My Custom Node',
      createNode: this.createCustomNode.bind(this),
      components: {
        editor: CustomNodeEditor,
        renderer: CustomNodeRenderer
      }
    });
  }
  
  onunload() {
    // æ’ä»¶å¸è½½æ—¶æ‰§è¡Œæ¸…ç†
    this.cleanup();
  }
  
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  
  async saveSettings() {
    await this.saveData(this.settings);
  }
}
```

#### 2. æ’ä»¶é…ç½®ç³»ç»Ÿ
```typescript
class PluginSettingsTab extends PluginSettingTab {
  constructor(app: App, plugin: MyPlugin) {
    super(app, plugin);
  }
  
  display(): void {
    const { containerEl } = this;
    containerEl.empty();
    
    // APIé…ç½®
    new Setting(containerEl)
      .setName('API Key')
      .setDesc('Enter your API key for external services')
      .addText(text => text
        .setValue(this.plugin.settings.apiKey)
        .onChange(async (value) => {
          this.plugin.settings.apiKey = value;
          await this.plugin.saveSettings();
        }));
    
    // åŠŸèƒ½å¼€å…³
    new Setting(containerEl)
      .setName('Enable Advanced Features')
      .setDesc('Enable advanced plugin features')
      .addToggle(toggle => toggle
        .setValue(this.plugin.settings.enableAdvanced)
        .onChange(async (value) => {
          this.plugin.settings.enableAdvanced = value;
          await this.plugin.saveSettings();
        }));
  }
}
```

### æ’ä»¶ç”Ÿæ€ç®¡ç†

#### 1. æ’ä»¶å‘ç°å’Œå®‰è£…
```typescript
interface PluginDiscoveryService {
  // æ’ä»¶å¸‚åœº
  marketplace: {
    searchPlugins: (query: string, filters: SearchFilters) => Promise<PluginSearchResult[]>;
    getPluginDetails: (pluginId: string) => Promise<PluginDetails>;
    getPluginReviews: (pluginId: string) => Promise<PluginReview[]>;
    installPlugin: (pluginId: string) => Promise<InstallResult>;
  };
  
  // æ’ä»¶åˆ†ç±»
  categories: {
    listCategories: () => PluginCategory[];
    getPluginsByCategory: (categoryId: string) => Promise<Plugin[]>;
    getFeaturedPlugins: () => Promise<Plugin[]>;
    getRecommendedPlugins: (userProfile: UserProfile) => Promise<Plugin[]>;
  };
  
  // æ›´æ–°ç®¡ç†
  updates: {
    checkForUpdates: () => Promise<PluginUpdate[]>;
    updatePlugin: (pluginId: string) => Promise<UpdateResult>;
    autoUpdateEnabled: (pluginId: string) => boolean;
    setAutoUpdate: (pluginId: string, enabled: boolean) => void;
  };
}
```

#### 2. æ’ä»¶è´¨é‡ä¿è¯
```typescript
interface PluginQualityAssurance {
  // ä»£ç å®¡æŸ¥
  codeReview: {
    securityScan: (pluginCode: string) => SecurityScanResult;
    performanceAnalysis: (plugin: Plugin) => PerformanceReport;
    compatibilityCheck: (plugin: Plugin, version: string) => CompatibilityResult;
  };
  
  // ç¤¾åŒºè¯„ä»·
  communityFeedback: {
    ratings: PluginRating[];
    reviews: PluginReview[];
    reportIssue: (pluginId: string, issue: IssueReport) => Promise<void>;
    flagContent: (pluginId: string, reason: string) => Promise<void>;
  };
  
  // å®˜æ–¹è®¤è¯
  certification: {
    verifiedDeveloper: boolean;
    officialPlugin: boolean;
    securityCertified: boolean;
    performanceCertified: boolean;
  };
}
```

### æ’ä»¶ç³»ç»Ÿä¼˜åŠ¿

#### 1. **å¼€å‘è€…å‹å¥½**
- å®Œæ•´çš„APIæ–‡æ¡£å’Œå¼€å‘å·¥å…·
- çƒ­é‡è½½å¼€å‘ç¯å¢ƒ
- TypeScriptç±»å‹å®‰å…¨
- ä¸°å¯Œçš„ç¤ºä¾‹å’Œæ¨¡æ¿

#### 2. **ç”¨æˆ·ä½“éªŒ**
- ä¸€é”®å®‰è£…å’Œç®¡ç†
- ç»†ç²’åº¦æƒé™æ§åˆ¶
- è‡ªåŠ¨æ›´æ–°å’Œå›æ»š
- ä¸ªæ€§åŒ–æ¨è

#### 3. **ç”Ÿæ€å¥åº·**
- å¼€æºç¤¾åŒºé©±åŠ¨
- è´¨é‡ä¿è¯æœºåˆ¶
- å¼€å‘è€…æ¿€åŠ±
- é•¿æœŸç»´æŠ¤æ”¯æŒ

è¿™ç§Obsidiané£æ ¼çš„æ’ä»¶ç³»ç»Ÿå°†ä¸ºGraph-ccæä¾›å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ï¼Œè®©ç¤¾åŒºèƒ½å¤Ÿè´¡çŒ®å„ç§ä¸“ä¸šåŒ–çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¿æŒæ ¸å¿ƒç³»ç»Ÿçš„ç¨³å®šæ€§å’Œç®€æ´æ€§ã€‚

#### çŠ¶æ€ç®¡ç†æ¶æ„
```typescript
GraphStore {
  // çŸ¥è¯†å±‚çŠ¶æ€
  knowledge: {
    currentKnowledgeBase: KnowledgeBase;
    knowledgeBases: Record<string, KnowledgeBase>;
  };
  
  // è§†å›¾å±‚çŠ¶æ€
  views: {
    currentViewId: EntityId;
    viewConfigs: Record<EntityId, ViewConfig>;
    layoutCache: Record<string, LayoutInfo>;
  };
  
  // è£…é¥°å±‚çŠ¶æ€
  decorations: Record<ViewId, DecorationLayer>;
  
  // AIåä½œçŠ¶æ€
  ai: {
    suggestions: RelationSuggestion[];
    generationHistory: GenerationRecord[];
    isProcessing: boolean;
  };
  
  // æ’ä»¶ç³»ç»ŸçŠ¶æ€
  plugins: {
    installed: Record<string, Plugin>;
    active: Set<string>;
    permissions: Record<string, Permission[]>;
  };
  
  // UIçŠ¶æ€
  ui: {
    selectedEntities: SelectionState;
    rightPanelOpen: boolean;
    currentTool: string;
  };
}
```

### 3. äº‹ä»¶-å‘½ä»¤ç³»ç»Ÿå±‚ (Event-Command System)

#### Event Sourcing æ¶æ„
åŸºäºäº‹ä»¶æº¯æºæ¨¡å¼ï¼Œäº‹ä»¶ä½œä¸ºçŠ¶æ€è®°å½•å’Œæ’¤é”€/é‡åšçš„åŸºç¡€ï¼š

```typescript
Event Sourcing Pattern {
  // å‘½ä»¤æ‰§è¡Œ â†’ äº‹ä»¶ç”Ÿæˆ â†’ çŠ¶æ€å˜æ›´
  command â†’ events â†’ state_change
  
  // äº‹ä»¶å­˜å‚¨ï¼ˆå†å²è®°å½•ï¼‰
  eventStore: DomainEvent[]
  
  // æ’¤é”€/é‡åšæ ˆ
  undoStack: DomainEvent[]
  redoStack: DomainEvent[]
  
  // çŠ¶æ€é‡å»º
  rebuildState(events) â†’ currentState
}
```

#### æ ¸å¿ƒåŸç†
- **å‘½ä»¤åŒ…å«æ’¤é”€é€»è¾‘**ï¼šæ¯ä¸ªå‘½ä»¤çŸ¥é“å¦‚ä½•æ‰§è¡Œå’Œæ’¤é”€è‡ªå·±çš„æ“ä½œ
- **äº‹ä»¶è®°å½•æ“ä½œå†å²**ï¼šäº‹ä»¶ç”¨äºå®¡è®¡ã€é€šçŸ¥å’Œå†å²è®°å½•ï¼Œä¸åŒ…å«æ’¤é”€é€»è¾‘
- **æ’¤é”€æ ˆå­˜å‚¨å‘½ä»¤**ï¼šæ’¤é”€/é‡åšåŸºäºå‘½ä»¤å¯¹è±¡ï¼Œè€Œéäº‹ä»¶å›æº¯
- **é«˜å†…èšè®¾è®¡**ï¼šå‘½ä»¤çš„æ‰§è¡Œå’Œæ’¤é”€é€»è¾‘ç´§å¯†å…³è”ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•

#### å‘½ä»¤ç±»å‹åˆ†ç±»
- **node-commands**: èŠ‚ç‚¹çš„ CRUD æ“ä½œï¼Œäº§ç”ŸèŠ‚ç‚¹ç›¸å…³äº‹ä»¶
- **edge-commands**: è¾¹çš„åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼Œäº§ç”Ÿå…³ç³»äº‹ä»¶  
- **block-commands**: å†…å®¹å—çš„æ“ä½œï¼Œäº§ç”Ÿå†…å®¹äº‹ä»¶
- **view-commands**: è§†å›¾å’Œå¸ƒå±€ç®¡ç†ï¼Œäº§ç”Ÿè§†å›¾äº‹ä»¶

### 4. ç»„ä»¶æ¶æ„å±‚ (Component Architecture)

#### æ ¸å¿ƒç»„ä»¶å±‚æ¬¡
```
MainLayout
â”œâ”€â”€ ViewTabs (è§†å›¾åˆ‡æ¢)
â”œâ”€â”€ WhiteboardView (ç©ºé—´è§†å›¾)
â”‚   â”œâ”€â”€ UnifiedNode (ç»Ÿä¸€èŠ‚ç‚¹ç»„ä»¶)
â”‚   â”‚   â”œâ”€â”€ DotNode (ç‚¹æ¨¡å¼)
â”‚   â”‚   â”œâ”€â”€ BoxNode (æ¡†æ¨¡å¼)
â”‚   â”‚   â””â”€â”€ CardNode (å¡ç‰‡æ¨¡å¼)
â”‚   â”œâ”€â”€ GraphEdge (å›¾è¾¹ç»„ä»¶)
â”‚   â””â”€â”€ FloatingToolbar (æµ®åŠ¨å·¥å…·æ )
â”œâ”€â”€ LinearView (çº¿æ€§è§†å›¾)
â”œâ”€â”€ MediaView (åª’ä½“è§†å›¾)
â””â”€â”€ RightPanel (å³ä¾§é¢æ¿)
    â”œâ”€â”€ NodeView (èŠ‚ç‚¹è¯¦æƒ…)
    â”œâ”€â”€ EdgeView (è¾¹è¯¦æƒ…)
    â””â”€â”€ RelationView (å…³ç³»è¯¦æƒ…)
```

#### ç»„ä»¶è®¾è®¡åŸåˆ™
- **èŒè´£å•ä¸€**: æ¯ä¸ªç»„ä»¶ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½
- **æ•°æ®æµå‘**: å•å‘æ•°æ®æµï¼Œé€šè¿‡ props å’Œå›è°ƒé€šä¿¡
- **çŠ¶æ€æå‡**: å…±äº«çŠ¶æ€ç®¡ç†åœ¨ Zustand Store ä¸­
- **ç»„åˆä¼˜äºç»§æ‰¿**: é€šè¿‡ç»„ä»¶ç»„åˆå®ç°å¤æ‚åŠŸèƒ½

## å…³é”®æŠ€æœ¯å†³ç­–

### 1. åæ ‡ç³»ç»Ÿè®¾è®¡
**å†³ç­–**: å­˜å‚¨ä¸­å¿ƒç‚¹åæ ‡ï¼Œæ¸²æŸ“æ—¶è®¡ç®—å·¦ä¸Šè§’ä½ç½®
**åŸå› **: 
- ä¸åŒæ˜¾ç¤ºæ¨¡å¼ï¼ˆç‚¹/æ¡†/å¡ç‰‡ï¼‰ä¿æŒä½ç½®ä¸€è‡´æ€§
- ç®€åŒ–èŠ‚ç‚¹åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼çš„é€»è¾‘
- ä¾¿äºå®ç°ç²¾ç¡®çš„è¿æ¥ç‚¹å¯¹é½

### 2. å¯Œæ–‡æœ¬ç¼–è¾‘é›†æˆ
**å†³ç­–**: å…¨ç³»ç»Ÿä½¿ç”¨ TipTap ç»Ÿä¸€ç¼–è¾‘ä½“éªŒ
**åŸå› **:
- è½»é‡çº§æ¶æ„ï¼Œæ›´å¥½çš„æ€§èƒ½
- ç°ä»£åŒ–APIè®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- æ›´å¥½çš„AIå·¥å…·å…¼å®¹æ€§

### 3. å›¾å½¢äº¤äº’åº“é€‰æ‹©
**å†³ç­–**: ä½¿ç”¨ React Flow ä½œä¸ºå›¾å½¢äº¤äº’åŸºç¡€
**åŸå› **:
- æˆç†Ÿçš„èŠ‚ç‚¹æ‹–æ‹½å’Œè¿æ¥åŠŸèƒ½
- è‰¯å¥½çš„æ€§èƒ½å’Œæ‰©å±•æ€§
- æ´»è·ƒçš„ç¤¾åŒºå’Œæ–‡æ¡£æ”¯æŒ

### 4. çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ
**å†³ç­–**: Zustand + Command Pattern
**åŸå› **:
- Zustand æä¾›è½»é‡çº§çŠ¶æ€ç®¡ç†
- Command Pattern æ”¯æŒå®Œæ•´çš„æ’¤é”€/é‡åš
- ä¸¤è€…ç»“åˆæä¾›æ—¢ç®€å•åˆå¼ºå¤§çš„çŠ¶æ€æ§åˆ¶

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ¸²æŸ“ä¼˜åŒ–
- **è™šæ‹ŸåŒ–**: å¤§è§„æ¨¡å›¾è°±çš„èŠ‚ç‚¹è™šæ‹ŸåŒ–æ¸²æŸ“
- **React.memo**: ç»„ä»¶çº§åˆ«çš„æ¸²æŸ“ä¼˜åŒ–
- **é€‰æ‹©å™¨ä¼˜åŒ–**: Zustand çš„ç»†ç²’åº¦çŠ¶æ€è®¢é˜…

### 2. æ•°æ®ä¼˜åŒ–
- **å¢é‡æ›´æ–°**: åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†
- **å»¶è¿ŸåŠ è½½**: æŒ‰éœ€åŠ è½½è§†å›¾æ•°æ®
- **ç¼“å­˜ç­–ç•¥**: è®¡ç®—ç»“æœç¼“å­˜å’Œå¤±æ•ˆæœºåˆ¶

### 3. äº¤äº’ä¼˜åŒ–
- **é˜²æŠ–èŠ‚æµ**: é¢‘ç¹æ“ä½œçš„æ€§èƒ½ä¿æŠ¤
- **æ‰¹é‡æ“ä½œ**: åˆå¹¶ç›¸å…³çš„çŠ¶æ€æ›´æ–°
- **å¼‚æ­¥å¤„ç†**: éé˜»å¡çš„æ•°æ®å¤„ç†æµç¨‹

## åˆ†å±‚æ•°æ®æµæ¶æ„

### æ•°æ®æµå‘è®¾è®¡

ç³»ç»Ÿçš„æ•°æ®åœ¨ä¸‰ä¸ªå±‚æ¬¡é—´æŒ‰ç…§æ˜ç¡®çš„è§„åˆ™æµåŠ¨ï¼š

```
ç”¨æˆ·æ“ä½œ â†’ äº¤äº’æ§åˆ¶å±‚ â†’ çŸ¥è¯†å±‚/è§†å›¾å±‚/è£…é¥°å±‚ â†’ çŠ¶æ€æ›´æ–° â†’ UIé‡æ¸²æŸ“
    â†“           â†“             â†“                â†“         â†“
  ç™½æ¿äº¤äº’    å‘½ä»¤åˆ†å‘      åˆ†å±‚æ•°æ®å¤„ç†         çŠ¶æ€åŒæ­¥    è§†è§‰åé¦ˆ
    â†“           â†“             â†“                â†“         â†“
  AIå»ºè®®      æ’ä»¶å¤„ç†      è¯­ä¹‰æå‡æœºåˆ¶        è®¢é˜…é€šçŸ¥    å¤šè§†å›¾åŒæ­¥
```

### å±‚é—´äº¤äº’è§„åˆ™

#### 1. çŸ¥è¯†å±‚ä¼˜å…ˆåŸåˆ™
```typescript
// AIä¼˜å…ˆåœ¨çŸ¥è¯†å±‚å·¥ä½œ
interface KnowledgeLayerFirst {
  // âœ… æ¨èï¼šAIç›´æ¥æ“ä½œè¯­ä¹‰ç»“æ„
  ai.generateNode(prompt, context) â†’ Node
  
  // âœ… æ¨èï¼šç”¨æˆ·æ“ä½œè‡ªåŠ¨æå‡åˆ°çŸ¥è¯†å±‚
  whiteboard.createTextBox(text) â†’ Node.create(title: text)
  
  // âŒ é¿å…ï¼šç›´æ¥åœ¨è§†å›¾å±‚åšAIæ“ä½œ
  ai.styleSuggestion(nodeVisual) // åº”è¯¥åŸºäºNodeå†…å®¹ï¼Œä¸æ˜¯visual
}
```

#### 2. è§†å›¾å±‚å“åº”æœºåˆ¶
```typescript
// çŸ¥è¯†å±‚å˜åŒ– â†’ å¤šè§†å›¾è‡ªåŠ¨æ›´æ–°
interface ViewLayerResponse {
  onKnowledgeChange: {
    // åŒä¸€ä¸ªNodeåœ¨ä¸åŒè§†å›¾ä¸­çš„è¡¨ç°è‡ªåŠ¨åŒæ­¥
    updateWhiteboardView(node: Node): void;
    updateLinearView(node: Node): void;
    updateMediaView(node: Node): void;
  };
  
  // è§†å›¾ç‰¹å®šçš„æ ·å¼å˜åŒ–ä¸å½±å“å…¶ä»–è§†å›¾
  onViewStyleChange: {
    updateCurrentViewOnly(nodeId: EntityId, style: ViewStyle): void;
  };
}
```

#### 3. è£…é¥°å±‚éš”ç¦»æœºåˆ¶
```typescript
// è£…é¥°å±‚å®Œå…¨ç‹¬ç«‹ï¼Œä¸å½±å“çŸ¥è¯†å’Œè§†å›¾
interface DecorationLayerIsolation {
  // è£…é¥°æ“ä½œ
  addFreeDrawing(path: SVGPath, viewId: ViewId): void;
  addSticker(sticker: Sticker, position: Point): void;
  
  // è£…é¥°æå‡ï¼ˆç”¨æˆ·ä¸»åŠ¨ï¼‰
  promoteDrawingToNode(drawingId: string): Node;
  promoteAnnotationToAttribute(annotationId: string, entityId: EntityId): void;
}
```

### AIåä½œæ•°æ®æµ

#### AIåœ¨çŸ¥è¯†å±‚çš„æ·±åº¦é›†æˆ
```typescript
interface AIKnowledgeIntegration {
  // è¾“å…¥ï¼šçŸ¥è¯†ç»“æ„ + ç”¨æˆ·æ„å›¾
  input: {
    currentKnowledge: KnowledgeBase;
    userPrompt: string;
    context: Node[];
  };
  
  // AIå¤„ç†ï¼šè¯­ä¹‰ç†è§£ + ç»“æ„ç”Ÿæˆ
  processing: {
    analyzeSemantics(input): SemanticAnalysis;
    generateStructure(analysis): KnowledgeStructure;
    optimizeRelations(structure): OptimizedStructure;
  };
  
  // è¾“å‡ºï¼šçŸ¥è¯†å±‚æ›´æ–° + è§†å›¾è‡ªé€‚åº”
  output: {
    knowledgeUpdates: Command[];
    viewSuggestions: ViewOptimization[];
    decorationHints: DecorationSuggestion[];
  };
}
```

#### AIä¸æ’ä»¶ç³»ç»Ÿçš„åä½œ
```typescript
interface AIPluginCollaboration {
  // AIåŠŸèƒ½æ’ä»¶åŒ–
  aiPlugins: {
    relationSuggestion: RelationSuggestionPlugin;
    contentGeneration: ContentGenerationPlugin;
    knowledgeOptimization: OptimizationPlugin;
  };
  
  // æ’ä»¶é—´é€šä¿¡
  pluginMessaging: {
    // AIæ’ä»¶å¯ä»¥è°ƒç”¨å…¶ä»–åŠŸèƒ½æ’ä»¶
    aiPlugin.requestDataSource(query) â†’ dataSourcePlugin.fetch(query);
    aiPlugin.requestExport(format) â†’ exportPlugin.generate(format);
  };
  
  // æ’ä»¶æƒé™ç®¡ç†
  permissions: {
    aiPlugins: ['knowledge.read', 'knowledge.write', 'network.access'];
    viewPlugins: ['view.render', 'view.style'];
    dataPlugins: ['data.import', 'data.export'];
  };
}
```

### æ¸è¿›å¼ç”¨æˆ·ä½“éªŒæ•°æ®æµ

#### ä»ç™½æ¿åˆ°çŸ¥è¯†å›¾è°±çš„å‡çº§è·¯å¾„
```typescript
interface ProgressiveUpgrade {
  // é˜¶æ®µ1ï¼šè‡ªç”±ç™½æ¿
  freeDrawing: {
    userAction: 'draw rectangle, add text';
    systemResponse: 'store in decoration layer';
    aiSuggestion: 'convert to knowledge node?';
  };
  
  // é˜¶æ®µ2ï¼šåŠç»“æ„åŒ–
  semiStructured: {
    userAction: 'accept AI suggestion';
    systemResponse: 'promote to view layer with semantic hint';
    aiSuggestion: 'suggest relations with existing nodes?';
  };
  
  // é˜¶æ®µ3ï¼šå®Œå…¨ç»“æ„åŒ–
  fullyStructured: {
    userAction: 'confirm relations';
    systemResponse: 'create in knowledge layer';
    aiSuggestion: 'optimize knowledge structure?';
  };
}
```

### æ•°æ®æŒä¹…åŒ–ç­–ç•¥

#### åˆ†å±‚æŒä¹…åŒ–æœºåˆ¶
```typescript
interface LayeredPersistence {
  // çŸ¥è¯†å±‚ï¼šå®Œæ•´æŒä¹…åŒ–
  knowledgeLayer: {
    storage: 'primary database';
    backup: 'version control with full history';
    sync: 'real-time collaboration';
  };
  
  // è§†å›¾å±‚ï¼šæŒ‰éœ€æŒä¹…åŒ–
  viewLayer: {
    storage: 'layout cache + user preferences';
    backup: 'periodic snapshots';
    sync: 'layout sharing between users';
  };
  
  // è£…é¥°å±‚ï¼šå¯é€‰æŒä¹…åŒ–
  decorationLayer: {
    storage: 'session storage + optional save';
    backup: 'user explicit save only';
    sync: 'real-time visual collaboration';
  };
}
```

è¿™ç§åˆ†å±‚æ•°æ®æµæ¶æ„ç¡®ä¿äº†ï¼š
- **è¯­ä¹‰ç¨³å®šæ€§**: çŸ¥è¯†ç»“æ„ä¸è¢«ä¸´æ—¶è§†è§‰å…ƒç´ å¹²æ‰°
- **AIç†è§£èƒ½åŠ›**: å¤§æ¨¡å‹å¯ä»¥ä¸“æ³¨äºè¯­ä¹‰å±‚çš„æ“ä½œ
- **ç”¨æˆ·ä½“éªŒçµæ´»æ€§**: æ”¯æŒä»ç®€å•ç»˜åˆ¶åˆ°å¤æ‚å»ºæ¨¡çš„æ¸è¿›ä½¿ç”¨
- **ç³»ç»Ÿæ‰©å±•æ€§**: æ¸…æ™°çš„å±‚æ¬¡åˆ’åˆ†ä¾¿äºåŠŸèƒ½æ‰©å±•å’Œæ’ä»¶å¼€å‘